---
title: The Many Places to run PowerShell in Azure
classes: wide
toc: true
---

## Intro
PowerShell is a fantastic language not just for managing Azure and related services, but for writing entire applications.
I have written applications that sync millions of tickets a month between two systems and support the automatic creation
and synchronization of tens of thousands of Microsoft 365 Groups based on business rules and user attributes.

However, the amount of services in Azure that support PowerShell are numerous, and it can be intimidating to decide which
is best for your PowerShell script or application. I hope this helps you decide with the various options. Note that I am
excluding "interactive" options like your local computer or Azure Cloud Shell, but definitely check out Azure Cloud Shell!

NOTE: This information is current as of December 2021 and stuff is changing all the time. For instance, Azure Automation
has been announced to support PowerShell 7 now and that's a big decision criteria switch.

## Summary
|Name | Pros | Cons| Best For|Not Recommended
|-----|------|-----|---------|---------------
[Azure Functions](https://docs.microsoft.com/en-us/azure/azure-functions/functions-reference-powershell)|Dirt Cheap<br><br>Auto Scaling<br><br>Durable Functions<br><br>Awesome Dev Tools (vscode/func core tools/azurite)<br><br>Community<br><br>App Insights<br><br>A/B Testing with Slots<br><br>Input/Output Bindings<br><br>Export to Containers/K8S|Debug not great<br><br>Learning Curve<br><br>On-Premise story is either hard (Azure Relay) or expensive (Azure Arc)|Short <10 min scripts<br><br>Event Driven Automation<br><br>Microservice Architectures and Web APIs, especially burstable demand<br><br>Filling in gaps in Power Apps / Power Automate|Out-Of-The-Box Scripts<br><br>Long-Running Batch Processes not written for Functions<br><br>On-Premise Activities
[Azure Automation](https://azure.microsoft.com/en-us/services/automation/#overview)|Venerable and Stable<br><br>Friendly UI<br><br>Simple On-Premise Setup (Hybrid Runbook Workers)<br><br>|Very slow development loop even if using hybrid runbook workers<br><br>Importing/Managing Custom Modules is a nightmare<br><br>Tooling is old (ISE only, vscode is broken)<br><br>UI Logs are truncated<br><br>Small 1CPU 400MB runtime environment shared between jobs<br><br>~~Powershell 5.1 Only~~ [Powershell 7.1 Preview Support!](https://azure.microsoft.com/en-us/updates/azure-automation-powershell-7/)|Simple Azure Tasks using Az Modules<br><br>Out-Of-The-Box Scripts<br><br>Automation Scripts requiring low performance (e.g. queries, reports, start/stop VMs, etc)<br><br>Long-Running Scripts<br><br>Scripts to perform on-premise tasks in an AD domain<br><br>Tasks that the helpdesk can be delegated to run on-demand|Scripts that require a large amount of memory (Hybrid Runbook Workers help mitigate but can be costly)<br><br>Constantly changing scripts requiring fast feedback/testing<br><br>Projects that use lots of modules that must be updated frequently
Container ([Azure Container Instances](https://azure.microsoft.com/en-us/services/container-instances/))|Way Cheaper than VMs (only runs when script runs)<br><br>Dev and Prod environments are same<br><br>Native VSCode Docker/Devcontainer Support<br><br>Bring along whatever additional dependencies you want<br><br>All other container-style deployment benefits|You need to roll your own "task runner" to start the container instances and verify their results (Functions/Automation/Power Automate make great triggers)<br><br>Not a lot of knowledge/documentation/support of specifically PowerShell in ACI<br><br>Roll-Your-Own scaling|People who want complete control over the process<br><br>High Performance scripts with a known load (Batch Tasks, etc.)<br><br>Scripts that need to bundle an external binary/dependency to work|Simple Solutions to hand off to standard Azure workers (limited UI)<br><br>Small Tasks to run frequently<br><br>People who want an ecosystem of tooling around the running and reporting of scripts.<br><br>Apps that require multiple isolated containers/components (AKS/ACA are better solutions)
Container ([Azure Container Apps](https://azure.microsoft.com/en-us/services/container-apps/))|Dapr sidecar to interoperate with other Microservices<br><br>Run as part of a larger microservices architecture<br><br>Scale to Zero for event driven automation<br><br>Get a lot of Kubernetes benefits without having to learn Kubernetes|Brand New as of Dec 2021, almost zero support/knowledge around using PWSH here<br><br>Must use DAPR .NET libraries, no friendly input/output bindings like Azure Functions|Scripts/Apps that need to behave as part of a larger microservices framework<br><br>Scripts that need to interoperate with other apps via Dapr/KEDA event framework<br><br>Multi-Container processes that use Powershell
Container ([Azure Kubernetes Service](https://azure.microsoft.com/en-us/services/kubernetes-service/))|Great option for Kubernetes-Comforable People<br><br>Solution can be portable to any Kubernetes platform including AWS/GCP/onprem<br><br>K8s control plane is a managed service|Requires Kubernetes knowledge and ability to build apps via Helm charts, etc.<br><br>If you don't learn/understand Kubernetes you are going to have a bad time.|Multi-cloud apps with minimal Kubernetes knowledge required<br><br>Multi-container or microservices platforms that have PowerShell components|Simple Automation Scripts<br><br>Scripts needing broad support and tooling
Virtual Machine (Scheduled Task)|Simple to learn and do, same as you do it on premise|One of the most expensive ways to run a script, especially if it is only run periodically e.g. weekly<br><br>Extremely opaque to operations, buried in scheduled tasks, who knows what this VM is for 5 years from now?|People who don't want to learn a better way and have $$$ to spend.<br><br>Scripts that have to interact with a components that only runs/supported on a Windows VM after install.|Basically anything that doesn't fit the main criteria
Virtual Machine ([PowerShell Universal](https://ironmansoftware.com/powershell-universal))|Automation and Dashboards, UI framework<br><br>Build Frontend/Backend Web Apps completely in PowerShell<br><br>Excellent Support and Active Community|Commercial Software ($)<br><br>Requires persistently-running VM|Helpdesk Apps<br><br>Simple Script Scheduling that is helpdesk-friendly|Complex multi-tiered applications or apps that need to scale to multiple hosts
Azure App Service ([PowerShell Universal](https://ironmansoftware.com/powershell-universal))|Same benefits as PSUniversal in a VM but on a more PaaS-style platform<br><br>No patches or OS to maintain
Virtual Machine ([ScriptRunner](https://www.scriptrunner.com/))|UI-Based Method of scheduling/Running Scripts|Commercial Software ($$$)<br><br>Requires persistently-running VM|A centralized script platform for on-demand scripts with authentication/authorization/auditing|People who are cheap (like me!)
